import{r as t}from"../../../../../react/index-4878784d.js";import{PresenceContext as l}from"../../context/PresenceContext-df1cf894.js";import{useConstant as d}from"../../utils/use-constant-c576bfd1.js";import{PopChild as C}from"./PopChild-aa46329b.js";const x=({children:s,initial:u,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:c,mode:m})=>{const e=d(M),p=t.useId(),i=t.useMemo(()=>({id:p,initial:u,isPresent:r,custom:a,onExitComplete:o=>{e.set(o,!0);for(const f of e.values())if(!f)return;n&&n()},register:o=>(e.set(o,!1),()=>e.delete(o))}),c?void 0:[r]);return t.useMemo(()=>{e.forEach((o,f)=>e.set(f,!1))},[r]),t.useEffect(()=>{!r&&!e.size&&n&&n()},[r]),m==="popLayout"&&(s=t.createElement(C,{isPresent:r},s)),t.createElement(l.Provider,{value:i},s)};function M(){return new Map}export{x as PresenceChild};
