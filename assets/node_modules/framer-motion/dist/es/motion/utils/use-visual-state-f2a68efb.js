import{r as y}from"../../../../../react/index-4878784d.js";import{isAnimationControls as g}from"../../animation/utils/is-animation-controls-e6c2e069.js";import{PresenceContext as S}from"../../context/PresenceContext-df1cf894.js";import{resolveVariantFromProps as h}from"../../render/utils/resolve-variants-0a9155e4.js";import{useConstant as E}from"../../utils/use-constant-c576bfd1.js";import{resolveMotionValue as N}from"../../value/utils/resolve-motion-value-43563deb.js";import{MotionContext as P}from"../../context/MotionContext/index-40524376.js";import{isControllingVariants as T,isVariantNode as $}from"../../render/utils/is-controlling-variants-0be66cfb.js";function b({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:o},r,n,a){const i={latestValues:B(r,n,a,t),renderState:e()};return o&&(i.mount=f=>o(r,f,i)),i}const z=t=>(e,o)=>{const r=y.useContext(P),n=y.useContext(S),a=()=>b(t,e,r,n);return o?a():E(a)};function B(t,e,o,r){const n={},a=r(t,{});for(const u in a)n[u]=N(a[u]);let{initial:i,animate:f}=t;const C=T(t),v=$(t);e&&v&&!C&&t.inherit!==!1&&(i===void 0&&(i=e.initial),f===void 0&&(f=e.animate));let c=o?o.initial===!1:!1;c=c||i===!1;const s=c?f:i;return s&&typeof s!="boolean"&&!g(s)&&(Array.isArray(s)?s:[s]).forEach(x=>{const d=h(t,x);if(!d)return;const{transitionEnd:V,transition:F,...k}=d;for(const m in k){let l=k[m];if(Array.isArray(l)){const A=c?l.length-1:0;l=l[A]}l!==null&&(n[m]=l)}for(const m in V)n[m]=V[m]}),n}export{z as makeUseVisualState};
