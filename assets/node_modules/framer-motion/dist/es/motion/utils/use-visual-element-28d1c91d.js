import{r as e}from"../../../../../react/index-4878784d.js";import{PresenceContext as C}from"../../context/PresenceContext-df1cf894.js";import{MotionContext as p}from"../../context/MotionContext/index-40524376.js";import{useIsomorphicLayoutEffect as s}from"../../utils/use-isomorphic-effect-3f07f387.js";import{LazyContext as x}from"../../context/LazyContext-0b1824d6.js";import{MotionConfigContext as d}from"../../context/MotionConfigContext-1a867db2.js";function y(f,a,r,n){const{visualElement:u}=e.useContext(p),c=e.useContext(x),o=e.useContext(C),m=e.useContext(d).reducedMotion,i=e.useRef();n=n||c.renderer,!i.current&&n&&(i.current=n(f,{visualState:a,parent:u,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:m}));const t=i.current;return e.useInsertionEffect(()=>{t&&t.update(r,o)}),s(()=>{t&&t.render()}),e.useEffect(()=>{t&&t.updateFeatures()}),(window.HandoffAppearAnimations?s:e.useEffect)(()=>{t&&t.animationState&&t.animationState.animateChanges()}),t}export{y as useVisualElement};
